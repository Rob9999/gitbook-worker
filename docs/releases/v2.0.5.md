---
version: 2.0.5.post1
date: 2026-01-08
status: released
history:
  - "init: 2026-01-08"
---

# GitBook Worker v2.0.5 (Hotfix) Release Notes

**Release Date**: January 8, 2026  
**Tag (GitHub)**: release-v.2.0.5-hotfix  
**Packaging Version**: 2.0.5.post1 (PEP 440)

## ðŸŽ¯ Summary
- Publisher surfaces the real LuaLaTeX error by locating and printing the best matching TeX `.log` excerpt when Pandoc fails.
- Orchestrator adds `--isolated` and `--logs-dir`, and auto-detects `<root>/content.yaml` for smoother local runs.
- Hardened emoji heading/bookmark handling to prevent `hyperref` crashes.

## ðŸ”§ Changes
- Publishing diagnostics:
  - On Pandoc/LuaLaTeX failure, search the temp output directory for `.log` files and prefer the newest `tex2pdf*.log` (fallback to matching the output PDF stem).
  - Print the last ~200 lines of the chosen TeX log for fast root-cause visibility.
  - Added a hint to keep LaTeX temp output for debugging (`ERDA_KEEP_LATEX_TEMP=1`).
- Publishing metadata:
  - Allow explicitly setting the document date via `publish.yml` (`project.date: YYYY-MM-DD`) or `book.json` (`"date": "YYYY-MM-DD"`). Manifest value wins; otherwise the existing frontmatter-derived behavior remains.
- Orchestrator ergonomics:
  - New flags: `--logs-dir` and `--isolated`.
  - Default `--content-config` now auto-picks `<root>/content.yaml` or `<root>/content.yml` when present.
  - Repo root detection considers `content.yaml`/`content.yml` as a root marker (useful for multilingual layouts).
  - Subprocesses receive a consistent log-dir override via env (`DOCKER_LOG_DIR`).
- Emoji headings (LaTeX):
  - Make `\panEmoji` definition idempotent to avoid duplicate-definition errors.
  - Guard emoji-related macros in PDF strings so `hyperref` bookmarks stay stable.
- Content examples:
  - Added DE+EN sample pages for emojis in headings (`emoji-headings.md`) to regression-test PDF bookmarks/ToC and `hyperref` stability.
- Tests:
  - Default Matplotlib backend in the test suite to `Agg` to avoid Tk/Tcl dependency issues on Windows.

## âœ… Testing
- `python -m pytest gitbook_worker/tests -m "not slow" -q`

## ðŸ“Œ Notes
- Use tag `release-v.2.0.5-hotfix`; keep packaging at `2.0.5.post1` for PEP 440 compliance.
- For local debugging of LaTeX failures, set `ERDA_KEEP_LATEX_TEMP=1` to preserve the most relevant build artifacts.
