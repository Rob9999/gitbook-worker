"""Hangul (Korean) Jamo patterns for algorithmic generation.

This module contains the patterns for generating all 11,172 modern Hangul syllables
using the Unicode algorithm: (L × 21 + V) × 28 + T + 0xAC00

License: CC BY 4.0
"""

from typing import Dict, List, Tuple

# Leading consonants (초성, Choseong) - 19 patterns
L_PATTERNS: Dict[str, List[str]] = {
    "ᄀ": [  # g/k
        "##......",
        "#.......",
        "#.......",
        "#.......",
        "#.......",
        "##......",
        "........",
        "........",
    ],
    "ᄁ": [  # kk
        "##..##..",
        "#...#...",
        "#...#...",
        "#...#...",
        "#...#...",
        "##..##..",
        "........",
        "........",
    ],
    "ᄂ": [  # n
        "##......",
        "..#.....",
        "..#.....",
        "..#.....",
        "..#.....",
        "###.....",
        "........",
        "........",
    ],
    "ᄃ": [  # d/t
        "####....",
        "#.......",
        "#.......",
        "#.......",
        "#.......",
        "####....",
        "........",
        "........",
    ],
    "ᄄ": [  # tt
        "####.###",
        "#....#..",
        "#....#..",
        "#....#..",
        "#....#..",
        "####.###",
        "........",
        "........",
    ],
    "ᄅ": [  # r/l
        "###.....",
        "..#.....",
        "..#.....",
        "###.....",
        "..#.....",
        "..#.....",
        "........",
        "........",
    ],
    "ᄆ": [  # m
        "##......",
        "#.#.....",
        "#.#.....",
        "#.#.....",
        "#.#.....",
        "##......",
        "........",
        "........",
    ],
    "ᄇ": [  # b/p
        "####....",
        "#..#....",
        "#..#....",
        "####....",
        "#..#....",
        "####....",
        "........",
        "........",
    ],
    "ᄈ": [  # pp
        "####.###",
        "#..#.#.#",
        "#..#.#.#",
        "####.###",
        "#..#.#.#",
        "####.###",
        "........",
        "........",
    ],
    "ᄉ": [  # s
        "..#.....",
        ".#.#....",
        "#...#...",
        "#...#...",
        "........",
        "........",
        "........",
        "........",
    ],
    "ᄊ": [  # ss
        "..#...#.",
        ".#.#.#.#",
        "#...#..#",
        "#...#..#",
        "........",
        "........",
        "........",
        "........",
    ],
    "ᄋ": [  # ng (silent initially)
        ".####...",
        "#....#..",
        "#....#..",
        "#....#..",
        "#....#..",
        ".####...",
        "........",
        "........",
    ],
    "ᄌ": [  # j
        "####....",
        "..#.....",
        "..#.....",
        "..#.....",
        "..#.....",
        "..#.....",
        "........",
        "........",
    ],
    "ᄍ": [  # jj
        "####.###",
        "..#...#.",
        "..#...#.",
        "..#...#.",
        "..#...#.",
        "..#...#.",
        "........",
        "........",
    ],
    "ᄎ": [  # ch
        "..#.....",
        "####....",
        "..#.....",
        "..#.....",
        "..#.....",
        "..#.....",
        "........",
        "........",
    ],
    "ᄏ": [  # k
        "##......",
        "#.......",
        "#.......",
        "####....",
        "#.......",
        "##......",
        "........",
        "........",
    ],
    "ᄐ": [  # t
        "####....",
        "........",
        "####....",
        "#.......",
        "#.......",
        "####....",
        "........",
        "........",
    ],
    "ᄑ": [  # p
        "####....",
        "#..#....",
        "####....",
        "#..#....",
        "#..#....",
        "####....",
        "........",
        "........",
    ],
    "ᄒ": [  # h
        ".##.....",
        "#..#....",
        ".##.....",
        "#..#....",
        "#..#....",
        ".##.....",
        "........",
        "........",
    ],
}

# Vowels (중성, Jungseong) - 21 patterns
V_PATTERNS: Dict[str, List[str]] = {
    "ᅡ": [  # a
        "........",
        "...#....",
        "...#....",
        "...#####",
        "...#....",
        "...#....",
        "........",
        "........",
    ],
    "ᅢ": [  # ae
        "........",
        "..##....",
        "..##....",
        "..######",
        "..##....",
        "..##....",
        "........",
        "........",
    ],
    "ᅣ": [  # ya
        "........",
        "..##....",
        "..##....",
        "..######",
        "..##....",
        "..##....",
        "........",
        "........",
    ],
    "ᅤ": [  # yae
        "........",
        ".###....",
        ".###....",
        ".#######",
        ".###....",
        ".###....",
        "........",
        "........",
    ],
    "ᅥ": [  # eo
        "........",
        "....#...",
        "....#...",
        "#####...",
        "....#...",
        "....#...",
        "........",
        "........",
    ],
    "ᅦ": [  # e
        "........",
        "....##..",
        "....##..",
        "######..",
        "....##..",
        "....##..",
        "........",
        "........",
    ],
    "ᅧ": [  # yeo
        "........",
        "....##..",
        "....##..",
        "######..",
        "....##..",
        "....##..",
        "........",
        "........",
    ],
    "ᅨ": [  # ye
        "........",
        "....###.",
        "....###.",
        "#######.",
        "....###.",
        "....###.",
        "........",
        "........",
    ],
    "ᅩ": [  # o
        "........",
        "...####.",
        "...#....",
        "...#....",
        "...#....",
        "...####.",
        "........",
        "........",
    ],
    "ᅪ": [  # wa
        "........",
        "..#####.",
        "..#..#..",
        "..####..",
        "..#..#..",
        "..#####.",
        "........",
        "........",
    ],
    "ᅫ": [  # wae
        "........",
        "..#####.",
        "..##.#..",
        "..#####.",
        "..##.#..",
        "..#####.",
        "........",
        "........",
    ],
    "ᅬ": [  # oe
        "........",
        "...#####",
        "...##...",
        "...####.",
        "...##...",
        "...#####",
        "........",
        "........",
    ],
    "ᅭ": [  # yo
        "........",
        "..#####.",
        "..##....",
        "..##....",
        "..##....",
        "..#####.",
        "........",
        "........",
    ],
    "ᅮ": [  # u
        "........",
        "####....",
        "...#....",
        "...#....",
        "...#....",
        "####....",
        "........",
        "........",
    ],
    "ᅯ": [  # weo
        "........",
        "#####...",
        "...#.#..",
        "...###..",
        "...#.#..",
        "#####...",
        "........",
        "........",
    ],
    "ᅰ": [  # we
        "........",
        "#####...",
        "...##...",
        "...####.",
        "...##...",
        "#####...",
        "........",
        "........",
    ],
    "ᅱ": [  # wi
        "........",
        "#####...",
        "##.#....",
        "##.#....",
        "##.#....",
        "#####...",
        "........",
        "........",
    ],
    "ᅲ": [  # yu
        "........",
        "#####...",
        "##..#...",
        "##..#...",
        "##..#...",
        "#####...",
        "........",
        "........",
    ],
    "ᅳ": [  # eu
        "........",
        "........",
        "........",
        "#####...",
        "........",
        "........",
        "........",
        "........",
    ],
    "ᅴ": [  # ui
        "........",
        "....#...",
        "....#...",
        "#####...",
        "....#...",
        "....#...",
        "........",
        "........",
    ],
    "ᅵ": [  # i
        "........",
        "....#...",
        "....#...",
        "....#...",
        "....#...",
        "....#...",
        "........",
        "........",
    ],
}

# Trailing consonants (종성, Jongseong) - 28 patterns (including empty)
T_PATTERNS: Dict[str, List[str]] = {
    "": [  # No final consonant
        "........",
        "........",
        "........",
        "........",
        "........",
        "........",
        "........",
        "........",
    ],
    "ᆨ": [  # g/k
        "........",
        "........",
        "........",
        "........",
        "........",
        "....##..",
        "....#...",
        "....##..",
    ],
    "ᆩ": [  # kk
        "........",
        "........",
        "........",
        "........",
        "........",
        "..##.##.",
        "..#..#..",
        "..##.##.",
    ],
    "ᆪ": [  # gs
        "........",
        "........",
        "........",
        "........",
        "........",
        "..##.#..",
        "..#.#.#.",
        "..##....",
    ],
    "ᆫ": [  # n
        "........",
        "........",
        "........",
        "........",
        "........",
        "....##..",
        "......#.",
        "....###.",
    ],
    "ᆬ": [  # nj
        "........",
        "........",
        "........",
        "........",
        "........",
        "..##.##.",
        "....#.#.",
        "..###.#.",
    ],
    "ᆭ": [  # nh
        "........",
        "........",
        "........",
        "........",
        "........",
        "..##.#..",
        "....#.#.",
        "..###.#.",
    ],
    "ᆮ": [  # d/t
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        "...#....",
        "...###..",
    ],
    "ᆯ": [  # l
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        ".....#..",
        ".....#..",
    ],
    "ᆰ": [  # lg
        "........",
        "........",
        "........",
        "........",
        "........",
        "..###.#.",
        "....#.#.",
        "....#.#.",
    ],
    "ᆱ": [  # lm
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###.##.",
        "...#.#.#",
        "...#.##.",
    ],
    "ᆲ": [  # lb
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###.##.",
        "...#.#.#",
        ".###.##.",
    ],
    "ᆳ": [  # ls
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###..#.",
        "...#.#.#",
        "...#....",
    ],
    "ᆴ": [  # lt
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###.##.",
        "...#..#.",
        "...#.##.",
    ],
    "ᆵ": [  # lp
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###.##.",
        "...#.#.#",
        ".###.##.",
    ],
    "ᆶ": [  # lh
        "........",
        "........",
        "........",
        "........",
        "........",
        ".###.#..",
        "...#.#.#",
        "...#.#..",
    ],
    "ᆷ": [  # m
        "........",
        "........",
        "........",
        "........",
        "........",
        "....##..",
        "....#.#.",
        "....##..",
    ],
    "ᆸ": [  # b/p
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        "...#.#..",
        "...###..",
    ],
    "ᆹ": [  # ps
        "........",
        "........",
        "........",
        "........",
        "........",
        "..###.#.",
        "..#.#.#.",
        "..###...",
    ],
    "ᆺ": [  # s
        "........",
        "........",
        "........",
        "........",
        "........",
        ".....#..",
        "....#.#.",
        "...#...#",
    ],
    "ᆻ": [  # ss
        "........",
        "........",
        "........",
        "........",
        "........",
        "...#..#.",
        "..#.#.#.",
        ".#...#..",
    ],
    "ᆼ": [  # ng
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        "..#...#.",
        "...###..",
    ],
    "ᆽ": [  # j
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        ".....#..",
        ".....#..",
    ],
    "ᆾ": [  # ch
        "........",
        "........",
        "........",
        "........",
        "........",
        ".....#..",
        "...###..",
        ".....#..",
    ],
    "ᆿ": [  # k
        "........",
        "........",
        "........",
        "........",
        "........",
        "....##..",
        "....#...",
        "...###..",
    ],
    "ᇀ": [  # t
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        "........",
        "...###..",
    ],
    "ᇁ": [  # p
        "........",
        "........",
        "........",
        "........",
        "........",
        "...###..",
        "...#.#..",
        "...###..",
    ],
    "ᇂ": [  # h
        "........",
        "........",
        "........",
        "........",
        "........",
        "....#...",
        "...#.#..",
        "....#...",
    ],
}


# Hangul pattern definitions (4x4)
L_PATTERNS = {
    "ㄱ": [
        "####",
        "#...",
        "#...",
        "#...",
    ],
    "ㄲ": [
        "#..#",
        "#..#",
        "#..#",
        "#..#",
    ],
    "ㄴ": [
        "#...",
        "#...",
        "#...",
        "####",
    ],
    "ㄷ": [
        "####",
        "#..#",
        "#..#",
        "####",
    ],
    "ㄸ": [
        "####",
        "#..#",
        "#..#",
        "#..#",
    ],
    "ㄹ": [
        "####",
        "#..#",
        "####",
        "#..#",
    ],
    "ㅁ": [
        "####",
        "#..#",
        "#..#",
        "####",
    ],
    "ㅂ": [
        "#..#",
        "####",
        "#..#",
        "####",
    ],
    "ㅃ": [
        "#..#",
        "####",
        "#..#",
        "#..#",
    ],
    "ㅅ": [
        "#..#",
        ".#.#",
        "..#.",
        "..#.",
    ],
    "ㅆ": [
        "#..#",
        ".#.#",
        "#..#",
        "..#.",
    ],
    "ㅇ": [
        ".##.",
        "#..#",
        "#..#",
        ".##.",
    ],
    "ㅈ": [
        "####",
        "..#.",
        "..#.",
        "..#.",
    ],
    "ㅉ": [
        "####",
        "..#.",
        "####",
        "..#.",
    ],
    "ㅊ": [
        "#..#",
        "####",
        "..#.",
        "..#.",
    ],
    "ㅋ": [
        "####",
        "#..#",
        "#.#.",
        "#..#",
    ],
    "ㅌ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
    "ㅍ": [
        "####",
        "#..#",
        "####",
        "#..#",
    ],
    "ㅎ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
}

V_PATTERNS = {
    "ㅏ": [
        ".#..",
        ".#..",
        ".#..",
        "###.",
    ],
    "ㅐ": [
        "##.#",
        "..#.",
        "..#.",
        "##.#",
    ],
    "ㅑ": [
        ".#.#",
        ".#.#",
        ".#.#",
        "###.",
    ],
    "ㅒ": [
        "##.#",
        "..#.",
        "##.#",
        "##.#",
    ],
    "ㅓ": [
        "..#.",
        "..#.",
        "..#.",
        ".###",
    ],
    "ㅔ": [
        "#.##",
        "..#.",
        "..#.",
        "#.##",
    ],
    "ㅕ": [
        "..#.",
        "..#.",
        "..#.",
        ".#.#",
    ],
    "ㅖ": [
        "#.##",
        "..#.",
        "#.##",
        "#.##",
    ],
    "ㅗ": [
        "####",
        "..#.",
        "..#.",
        "..#.",
    ],
    "ㅘ": [
        "####",
        "..#.",
        "###.",
        "..#.",
    ],
    "ㅙ": [
        "####",
        "..#.",
        "##.#",
        "..#.",
    ],
    "ㅚ": [
        "####",
        "..#.",
        "..#.",
        "##.#",
    ],
    "ㅛ": [
        "#..#",
        "####",
        "..#.",
        "..#.",
    ],
    "ㅜ": [
        "..#.",
        "..#.",
        "####",
        "..#.",
    ],
    "ㅝ": [
        "..#.",
        "..#.",
        "###.",
        "..#.",
    ],
    "ㅞ": [
        "..#.",
        "..#.",
        "##.#",
        "..#.",
    ],
    "ㅟ": [
        "..#.",
        "..#.",
        "..#.",
        "##.#",
    ],
    "ㅠ": [
        "..#.",
        "..#.",
        "####",
        "#..#",
    ],
    "ㅡ": [
        "....",
        "####",
        "....",
        "....",
    ],
    "ㅢ": [
        "####",
        "..#.",
        "####",
        "..#.",
    ],
    "ㅣ": [
        "..#.",
        "..#.",
        "..#.",
        "..#.",
    ],
}

T_PATTERNS = {
    "": [
        "....",
        "....",
        "....",
        "....",
    ],
    "ㄱ": [
        "####",
        "#...",
        "#...",
        "#...",
    ],
    "ㄲ": [
        "#..#",
        "#..#",
        "#..#",
        "#..#",
    ],
    "ㄳ": [
        "#..#",
        "#.#.",
        "#..#",
        "#..#",
    ],
    "ㄴ": [
        "#...",
        "#...",
        "#...",
        "####",
    ],
    "ㄵ": [
        "#..#",
        "#..#",
        "#..#",
        "####",
    ],
    "ㄶ": [
        "#..#",
        "#..#",
        "####",
        "#..#",
    ],
    "ㄷ": [
        "####",
        "#..#",
        "#..#",
        "####",
    ],
    "ㄹ": [
        "####",
        "#..#",
        "####",
        "#..#",
    ],
    "ㄺ": [
        "####",
        "#..#",
        "####",
        "#...",
    ],
    "ㄻ": [
        "####",
        "#..#",
        "####",
        "####",
    ],
    "ㄼ": [
        "####",
        "#..#",
        "####",
        "#.#.",
    ],
    "ㄽ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
    "ㄾ": [
        "####",
        "#..#",
        "####",
        "#.##",
    ],
    "ㄿ": [
        "####",
        "#..#",
        "####",
        "#..#",
    ],
    "ㅀ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
    "ㅁ": [
        "####",
        "#..#",
        "#..#",
        "####",
    ],
    "ㅂ": [
        "#..#",
        "####",
        "#..#",
        "####",
    ],
    "ㅄ": [
        "#..#",
        "####",
        "#..#",
        "#.##",
    ],
    "ㅅ": [
        "#..#",
        ".#.#",
        "..#.",
        "..#.",
    ],
    "ㅆ": [
        "#..#",
        ".#.#",
        "#..#",
        "..#.",
    ],
    "ㅇ": [
        ".##.",
        "#..#",
        "#..#",
        ".##.",
    ],
    "ㅈ": [
        "####",
        "..#.",
        "..#.",
        "..#.",
    ],
    "ㅊ": [
        "#..#",
        "####",
        "..#.",
        "..#.",
    ],
    "ㅋ": [
        "####",
        "#..#",
        "#.#.",
        "#..#",
    ],
    "ㅌ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
    "ㅍ": [
        "####",
        "#..#",
        "####",
        "#..#",
    ],
    "ㅎ": [
        "####",
        "#..#",
        "####",
        "..#.",
    ],
}

L_LIST = [
    "ㄱ",
    "ㄲ",
    "ㄴ",
    "ㄷ",
    "ㄸ",
    "ㄹ",
    "ㅁ",
    "ㅂ",
    "ㅃ",
    "ㅅ",
    "ㅆ",
    "ㅇ",
    "ㅈ",
    "ㅉ",
    "ㅊ",
    "ㅋ",
    "ㅌ",
    "ㅍ",
    "ㅎ",
]

V_LIST = [
    "ㅏ",
    "ㅐ",
    "ㅑ",
    "ㅒ",
    "ㅓ",
    "ㅔ",
    "ㅕ",
    "ㅖ",
    "ㅗ",
    "ㅘ",
    "ㅙ",
    "ㅚ",
    "ㅛ",
    "ㅜ",
    "ㅝ",
    "ㅞ",
    "ㅟ",
    "ㅠ",
    "ㅡ",
    "ㅢ",
    "ㅣ",
]

T_LIST = [
    "",
    "ㄱ",
    "ㄲ",
    "ㄳ",
    "ㄴ",
    "ㄵ",
    "ㄶ",
    "ㄷ",
    "ㄹ",
    "ㄺ",
    "ㄻ",
    "ㄼ",
    "ㄽ",
    "ㄾ",
    "ㄿ",
    "ㅀ",
    "ㅁ",
    "ㅂ",
    "ㅄ",
    "ㅅ",
    "ㅆ",
    "ㅇ",
    "ㅈ",
    "ㅊ",
    "ㅋ",
    "ㅌ",
    "ㅍ",
    "ㅎ",
]

SBASE = 0xAC00


# Hangul syllable generation algorithm constants
HANGUL_BASE = 0xAC00  # First Hangul syllable (가)
HANGUL_END = 0xD7A3  # Last Hangul syllable (힣)
L_COUNT = 19  # Number of leading consonants
V_COUNT = 21  # Number of vowels
T_COUNT = 28  # Number of trailing consonants (including empty)
N_COUNT = V_COUNT * T_COUNT  # 588
S_COUNT = L_COUNT * N_COUNT  # 11172


def get_hangul_syllable_code(l_index: int, v_index: int, t_index: int) -> int:
    """Calculate Unicode code point for Hangul syllable.

    Args:
        l_index: Leading consonant index (0-18)
        v_index: Vowel index (0-20)
        t_index: Trailing consonant index (0-27)

    Returns:
        Unicode code point for the syllable
    """
    return HANGUL_BASE + (l_index * N_COUNT) + (v_index * T_COUNT) + t_index


def decompose_hangul_syllable(code: int) -> Tuple[int, int, int]:
    """Decompose Hangul syllable code point into L, V, T indices.

    Args:
        code: Unicode code point (0xAC00-0xD7A3)

    Returns:
        Tuple of (l_index, v_index, t_index)
    """
    if not (HANGUL_BASE <= code <= HANGUL_END):
        raise ValueError(f"Not a Hangul syllable: U+{code:04X}")

    syllable_index = code - HANGUL_BASE
    l_index = syllable_index // N_COUNT
    v_index = (syllable_index % N_COUNT) // T_COUNT
    t_index = syllable_index % T_COUNT

    return l_index, v_index, t_index


def combine_patterns(
    l_pattern: List[str], v_pattern: List[str], t_pattern: List[str]
) -> List[str]:
    """Combine L, V, T patterns into complete 8x8 glyph.

    Args:
        l_pattern: Leading consonant pattern (8 rows)
        v_pattern: Vowel pattern (8 rows)
        t_pattern: Trailing consonant pattern (8 rows)

    Returns:
        Combined 8x8 pattern (8 rows)
    """
    combined = []
    for i in range(8):
        row = ""
        for j in range(8):
            # Use OR logic: if any pattern has a pixel, draw it
            if (
                l_pattern[i][j] == "#"
                or v_pattern[i][j] == "#"
                or t_pattern[i][j] == "#"
            ):
                row += "#"
            else:
                row += "."
        combined.append(row)
    return combined
