version: 0.1.0
profiles:
  default:
    description: Default profile for the full orchestrator pipeline.
    steps:
    - check_if_to_publish
    - ensure_readme
    - update_citation
    - converter
    - engineering-document-formatter
    - publisher
    docker:
      use_registry: true
      image: ghcr.io/${repo}/publisher
      cache: true
  local:
    description: Local run without registry access.
    steps:
    - converter
    - publisher
    docker:
      use_registry: false
  publisher:
    description: Runs only the publisher step.
    steps:
    - publisher
    docker:
      use_registry: true
      image: ghcr.io/${repo}/publisher
      cache: true
meta:
  publish_on:
  - push
  - workflow_dispatch
  artifacts:
    keep_days: 7
project:
  name: The ERDA Book
  authors:
  - ERDA Team
  license: CC BY-SA 4.0
publish:
- path: ./
  out_format: pdf
  out_dir: ./publish
  out: the-erda-book.pdf
  source_type: folder
  source_format: markdown
  use_summary: true
  use_book_json: true
  summary_mode: gitbook
  summary_appendices_last: true
  keep_combined: true
  build: true
  reset_build_flag: false
  
  # Document Type System (v2.0.1+)
  use_document_types: true
  
  document_type_config:
    # Section order in SUMMARY.md
    section_order:
      - cover
      - dedication
      - preface
      - translators-note
      - list-of-tables
      - list-of-figures
      - list-of-abbreviations
      - list-of-symbols
      - list-of-equations
      - list-of-algorithms
      - list-of-listings
      - chapters
      - epilog
      - appendices
      - legal-notice
      - glossary
      - bibliography
      - index
      - attributions
      - errata
      - release-notes
      - colophon
    
    # Section titles for SUMMARY.md
    section_titles:
      dedication: "Dedication"
      preface: "Preface"
      translators-note: "Translator's Note"
      list-of-tables: "List of Tables"
      list-of-figures: "List of Figures"
      list-of-abbreviations: "List of Abbreviations"
      list-of-symbols: "List of Symbols"
      list-of-equations: "List of Equations"
      list-of-algorithms: "List of Algorithms"
      list-of-listings: "List of Listings"
      chapters: "Main Content"
      epilog: "Epilogue"
      appendices: "Appendices"
      legal-notice: "Legal Notices"
      glossary: "Glossary"
      bibliography: "References"
      index: "Index"
      attributions: "Acknowledgments"
      errata: "Errata"
      release-notes: "Release Notes"
      colophon: "Colophon"
    
    # Show in SUMMARY.md?
    show_in_summary:
      template: false
      placeholder: false
      example: true
      release-notes: true
      errata: true
      legal-notice: true
    
    # Auto-numbering
    auto_number_chapters: true
    auto_number_appendices: true  # A, B, C, ...
    auto_number_parts: true       # Part I, II, ...
    
    # Chapter-appendix handling
    chapter_appendix_indent: true
    chapter_appendix_prefix: "Appendix {chapter}.{id}"

    # Per-doc fallback weight
    default_order_weight: 100
  
  pdf_options:
    emoji_color: true
    emoji_bxcoloremoji: false
    main_font: DejaVu Serif
    sans_font: DejaVu Sans
    mono_font: DejaVu Sans Mono
    mainfont_fallback: Twemoji Mozilla:mode=harf; ERDA CC-BY CJK:mode=harf
    abort_if_missing_glyph: false
  assets:
  - path: content/.gitbook/assets
    type: images
    copy_to_output: true
